* DONE upgrade rescript


* DONE pass ci


* TODO add package assemble


** DONE add package assemble

# pass compile

# pass bdd test


** DONE commit


** DONE implement generatePackage

change isStart to extension type:

fix convertAllFileData

** DONE implement loadPackage

** DONE commit

** DONE convertAllFileData support packages
** DONE generate support packages

** DONE commit



** DONE package assemble: add Packages, Selected Packages

pass compile

** DONE pass bdd test




** DONE implement publishPackage, getAllPublishPackageInfos, getAllPublishPackageEntryExtensionProtocols, findPackage

publishPackage:
entry extension protocol data:name, version
name,
version,
account


getAllPublishPackageInfos:
entryProtocolName,
entryProtocolVersion



findPackage:

return binaryFile




getAllPublishPackageEntryExtensionProtocols:






** DONE pass compile

** DONE pass bdd test

** DONE commit


** DONE fix publishPackage, getAllPublishPackageInfos

** DONE pass bdd test

** DONE finish PackageShop

pass draft

** DONE fix PublishPackage

*** DONE pass draft


*** DONE pass compile


** DONE frontend: pass compile


** DONE assemble-space: pass bdd test


** TODO implement downloadPackage

# draft

# compile

# bdd test
# pacakge_manager.steps add case one



provide meta3d sdk repo

# run test



** TODO frontend: pass run test

test cloudbase


test 4everland


*** TODO publish package


*** TODO download package






** TODO ap assemble: add Packages, Selected Packages


** TODO ap assemble: update publish app

** TODO pass bdd test

** TODO pass run test


** TODO refactor: remove duplicate between package assemble and ap assemble









** TODO build like ap assemble

package is a collection, encapuslate by entry extension:
package = one entry extension + other extensions + contributes





no start extension, canvas


分为内部依赖和外部依赖

entry extension:
provide api, e.g. 
type service = 
    director: {
        getState: get engine state from meta3dState,
        setState,
        init,
        ...
    },
    gameObject:{
        create,
        ...
    }

# set outer dependency, e.g.
#     set meta3dWorkPluginWebGPUTriangleContributeName




如果入口扩展依赖的扩展和共享在该file中，则使用它们，并对外隐藏这些依赖；否则还是依赖于外部的扩展和共享！



shop:
# 选择到应用装配
# 选择到包装配
remain 选择


Extensions
Contributes
Packages


Selected Extensions
    mark Entry Extension
Selected Contributes

Selected Packages




meta3d:
# generateExtensionPackage
generatePackage
    like generateApp
        use entry extension instead of start extension

downloadPackage

    loadPackage
       register extensions, contributes
    #    return entry extension name, so can get its service by getExtensionService
    #    return entry extension name, so can get its service and set outer dependency by getPackageService(entry extension name, outer dependency data)
    #         set outer dependency, e.g.
    #             set meta3dWorkPluginWebGPUTriangleContributeName
       return entry extension name, so can get its service by getExtensionService(entry extension name)
            package outer dependency use registered extensions, contributes

       set entry extension name to dependency extension name map



so load multiple packages, then get their service and handle!
load packages contain same protocols will overwrite ones before!




use in ap assemble:

add Packages;

# loadPackage
#     set entry extension name to dependency extension name map

# extension can use package service by getExtensionService(entry extension name)

# package outer dependency use registered extensions, contributes

generateApp: add package to arrayBuffer

loadApp: load package to register all extensions(include entry extension), contributes


publishApp:
check dependency for package






service:
# publishExtensionPackage
publishPackage
    no config, only publish








** TODO publish

need protocol?
    use entry extension protocol?


*** TODO add extension package shop

show in extension package shop



** TODO download

use in local as webpack file


# ** TODO use one package by another package


** TODO use in ap

use like a extension




** TODO run test


*** TODO build engine package, use in ap to draw a triangle by webgpu




* TODO version management

** TODO fix bug

** TODO use select to show all versions of one extension/contribute protocol's implements




* TODO refactor
** TODO Index show Meta3d version and info without login


** TODO remove newName?



* TODO add ap marketplace

** TODO rename 商城 to 市场

** TODO 增加查看所有发布的应用

** TODO 能够在一个url中jump to 发布的应用

url: 
https://meta3d-platform-production.4everland.app?jump_to_published_application=true&&uid=xxx






* TODO publish